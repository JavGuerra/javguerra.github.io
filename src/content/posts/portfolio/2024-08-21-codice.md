---
route: codice
title: Códice
description: Mi git-blog sobre programación y formación TIC.
info: Página personal y blog Markdown elaborado con Astro y Tailwind que incluye filtrado por etiquetas, RSS y modo claro/oscuro automático.
author: JavGuerra
pubDate: 2024-08-21
coverImage:
  image: '@/assets/portfolio/codice.png'
  alt: Códice
tags:
    - web
    - código
    - Astro
    - SSG
    - Tailwind
    - JavaScript
    - TypeScript
    - Node.js
    - Markdown
    - responsive
    - accesibilidad
---

Hacia tiempo que quería darle un giro a mi anterior [git-blog elaborado con Jekill](/blog/hola-mundo). Entonces me topé con [Astro](https://astro.build/), un SSG en JavaScript/TypeScript, que usa Node.js, que cuenta una excelente documentación, y además incluye un tutorial para hacer un blog. Esto terminó de decidirme para hacer el cambio que ahora presento.

# Retos

Para hacer un nuevo blog, por delante se presentaban dos retos:

1. Realizar la aplicación para que fuera operativa al menos con la mayoría de funcionalidades que ya tenía en el anterior blog.
2. Migrar las entradas del blog anterior a la nueva estructura de la aplicación, lo que además implicaba repensar su estructura.

## La aplicación

Elaborar la aplicación fue realmente sencillo. Siempre hay atascos, pero con la documentación, el tutorial, el Discord de ayuda, los videos de YouTube y la IA, fueron subsanándose. El proyecto ha sido el mejor aprendizaje posible. 

Dos cosas me han llevado algo de tiempo:

1. Extender la colección de posts usando el esquema RSS.
2. Utilizar el componente «Image» de Astro.

Lo relativo a la colección es lógico, porque estaba usando conceptos nuevos y aprendiendo a usar la biblioteca Zod para definir y validar el esquema de los datos de las colección de entradas del blog.

Pero confieso que lo relativo al uso del componente Image me ha dado más de un problema, posiblemente, en parte, asociado al schema, pues no me ha sido posible usar imágenes con rutas relativas o rutas absolutas en los encabezados de las entradas.

Otro problema relacionado con Image tiene que ver con el atributo `src`. Si bien Image permite indicar una ruta relativa (/public) o remota (https), cuando se trata de usar la carpeta /src/assets surgen los problemas. La solución pasa por importar las imágenes, pero ¿qué pasa cuando se ha de importar una colección de imágenes, para, por ejemplo, el listado de los proyectos del portafolio?

Mi solución pasa por crear un arreglo con todas las imágenes importadas usando import.meta.glob(), y luego acceder a cada elemento del arreglo referenciado por su ruta, como se muestra aquí:

``` javascript
---
import portfolio from "@/content/_portfolio.json";
const images = import.meta.glob("@/assets/portfolio/*", { eager: true });

const projects = portfolio.projects.map(project => {
  const image = images[`/src/assets/portfolio/${project.img}`] as Record<string, any>;
  return { ...project, image };
---

projects.map(project => 
  <Image src={project.image.default} alt={project.alt} inferSize />
)
```
Este ejemplo simplificado mostrará la lista de imágenes asociadas a los proyectos.

## La migración

![Códice versión Jekill](@/assets/img/codice-jekill.png)

_Versión previa del blog en Jekill_

Tras conseguir que todo funcionase, llegó el turno de la migración, que pensaba que sería complicada, pero sólo fue laboriosa. 

Haciendo uso del filtrado de contenido fui cambiando los enlaces de Jekill de las referencias entre las distintas entradas, y creando el nuevo encabezado (`frontmatter`) de cada entrada escrita en Markdown.

A medida que este cambio se iba realizando fue necesario ir adaptando los estilos de texto haciendo uso de [Tailwind](https://tailwindcss.com/) y su plugin [Typography](https://github.com/tailwindlabs/tailwindcss-typography).

# Características

La aplicación cuenta con las siguientes secciones: portada, sobre mi, porfolio, blog, temas y enlaces recomendados. Hace uso de las características avanzadas de Astro, y cuenta con:

- RSS de contenidos
- Sitemap para SEO
- Tema de color
- Es accesible
- Es responsive

Lo mejor de todo es que ha sido divertido hacerlo, y conocer Astro, esta nueva y muy potente herramienta que creo que va a dar mucho juego.

# Saber más

- [Repositorio en GitHub](https://github.com/JavGuerra/javguerra.github.io)
- [git-blog anterior elaborado con Jekill](/blog/hola-mundo)
- [SSG](https://es.wikipedia.org/wiki/Generador_de_sitios_est%C3%A1ticos), [Astro](https://astro.build/) y [Astro en Wikipedia](https://es.wikipedia.org/wiki/Astro_(framework))
- [Tailwind](https://tailwindcss.com/) y [Typography](https://github.com/tailwindlabs/tailwindcss-typography)
- [Construye tu primer blog con Astro](https://docs.astro.build/es/tutorial/0-introduction/)
- [Curso de Astro, por Fazt, en Youtube](https://youtu.be/sOXW0ZnJxbQ?si=yLRwfY4lyOMaHypc)