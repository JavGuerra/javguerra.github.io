---
import { getCollection } from 'astro:content';
import { getSlugName } from '@/scripts/urlUtils';
import BlogPostCard from "@/components/BlogPostCard.astro";

const allPosts: Record<string, any>[] = await getCollection('posts');

let post;
if (allPosts.length) {
  const sortedPosts = allPosts.sort(
    (a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
  )

  const title = sortedPosts[0].data.title;
  const prefixedTitle = title.startsWith("Nuevo: ") ? title : `Nuevo: ${title}`;   
  sortedPosts[0].data.title = prefixedTitle;

  post = sortedPosts[0];
}
---

{ post && 
  <ul class="my-8 text-center md:text-left">
    <BlogPostCard
      frontmatter={post.data}
      href=`${post.data.route || getSlugName(post.slug)}`
    />
  </ul>
}
